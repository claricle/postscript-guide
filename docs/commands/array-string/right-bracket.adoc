---
layout: default
title: "]"
parent: Array and String Operations
grand_parent: Command Reference
nav_order: 3
---

== ]

Ends array construction by collecting all objects above the topmost mark into a new array.

=== Syntax

----
mark obj₀ ... objₙ₋₁ ] → array
----

=== Stack Effects

.Before
[cols="1,3"]
|===
| Level | Object

| n+1
| `mark`

| n
| `obj₀`

| ...
| ...

| 0
| `objₙ₋₁`
|===

.After
[cols="1,3"]
|===
| Level | Object

| 0
| `array` (containing obj₀ through objₙ₋₁)
|===

=== Description

The xref:right-bracket.adoc[`]`] operator completes array construction by:

1. Counting all objects on the operand stack down to the topmost mark
2. Removing those objects from the stack
3. Creating a new array containing those objects in order
4. Removing the mark
5. Pushing the new array on the stack

The array is created with the literal attribute and allocated in local or global VM according to the current VM allocation mode.

=== PostScript Level

*Level 1* and later

=== Examples

.Basic array construction
[source,postscript]
----
[ 1 2 3 ]        % Creates [1 2 3]
----

.Mixed types
[source,postscript]
----
[ 42 (text) /name [ nested ] ]
% Creates [42 (text) /name [nested]]
----

.Empty array
[source,postscript]
----
[ ]              % Creates []
----

.Computed values
[source,postscript]
----
[ 10 20 add 30 ] % Creates [30 30]
----

.Building from stack
[source,postscript]
----
1 2 3            % Stack: 1 2 3
mark exch exch exch  % Stack: mark 1 2 3
]                % Stack: [1 2 3]
----

=== Common Use Cases

==== Data Initialization

[source,postscript]
----
/primes [ 2 3 5 7 11 13 ] def
----

==== Coordinate Pairs

[source,postscript]
----
/point [ 100 200 ] def
----

==== Color Definitions

[source,postscript]
----
/red [ 1 0 0 ] def      % RGB
/cyan [ 0 1 1 1 ] def   % CMYK
----

=== Common Pitfalls

WARNING: *Unmatched Brackets* - The xref:right-bracket.adoc[`]`] operator requires a matching link:left-bracket.adoc[`[`] (mark) on the stack. Without it, an [`unmatchedmark`] error occurs.

[source,postscript]
----
1 2 3 ]  % Error: no matching [
----

WARNING: *Evaluation of Contents* - Objects between brackets are evaluated before being placed in the array.

[source,postscript]
----
[ /x 5 def ]     % Executes def, creates [5]
                 % NOT [/x 5 def]
----

TIP: *Immediate vs. Literal Arrays* - To create an array without evaluating its contents, use the `/{ ... }` executable array syntax (procedure syntax).

[source,postscript]
----
/proc { 1 2 add } def   % Procedure (unevaluated)
[ 1 2 add ]             % Array [3] (evaluated)
----

=== Error Conditions

[cols="1,3"]
|===
| Error | Condition

| [`stackoverflow`]
| Resulting array would overflow stack (extremely rare)

| [`unmatchedmark`]
| No mark on stack (no matching link:left-bracket.adoc)[`[`]

| [`VMerror`]
| Insufficient VM to allocate array
|===

=== Implementation Notes

* The xref:right-bracket.adoc[`]`] operator is syntactic sugar recognized during parsing
* When scanned, `[ ... ]` creates a literal array object
* The objects are placed in the array in the order they appeared between brackets
* Index 0 contains the first object after link:left-bracket.adoc[`[`]

=== Comparison with astore

The xref:right-bracket.adoc[`]`] operator is similar to xref:../astore.adoc[`astore`] but more convenient:

[source,postscript]
----
% Using [ ]
[ 1 2 3 ]

% Equivalent using astore
1 2 3 3 array astore
----

The bracket syntax is clearer and doesn't require knowing the count in advance.

=== See Also

* xref:left-bracket.adoc[`[`] - Begin array construction
* xref:../stack-manipulation/mark.adoc[`mark`] - Push mark object
* xref:../stack-manipulation/cleartomark.adoc[`cleartomark`] - Clear to mark
* xref:../array.adoc[`array`] - Create uninitialized array
* xref:../astore.adoc[`astore`] - Store stack into array
* xref:../packedarray.adoc[`packedarray`] - Create read-only array