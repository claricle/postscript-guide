---
layout: default
title: dictstack
parent: Command Reference
nav_order: 12
---

== dictstack

Copies all dictionaries from the dictionary stack into an array.

=== Syntax

----
array dictstack → subarray
----

=== Stack Effects

.Before
[cols="1,3"]
|===
| Level | Object

| 0
| `array` (must be large enough)
|===

.After
[cols="1,3"]
|===
| Level | Object

| 0
| `subarray` (portion of array used)
|===

=== Description

link:/docs/commands/references/dictstack/[`dictstack`] stores all elements of the dictionary stack into _array_ and returns an object describing the initial n-element subarray, where n is the current depth of the dictionary stack.

Dictionaries are copied in order:
* Element 0 ← bottommost dictionary (systemdict)
* Element n-1 ← topmost dictionary (current)

The dictionary stack itself is unchanged.

=== PostScript Level

*Level 1* and later

=== Examples

.Capturing dictionary stack
[source,postscript]
----
countdictstack array dictstack
% Returns subarray with all dictionaries
----

.Examining stack contents
[source,postscript]
----
10 array dictstack
{ dup /FontDirectory known { pop } { = } ifelse }
forall
----

.Debugging dictionary context
[source,postscript]
----
/showDictStack {
  countdictstack array dictstack
  0 exch {
    exch
    (Dict ) print dup =only (\n) print
    1 add
  } forall
  pop
} def
----

=== Common Use Cases

==== State Inspection

[source,postscript]
----
% Save dictionary stack state
/savedStack countdictstack array dictstack def
% ... operations ...
% Compare with current
countdictstack array dictstack
% Check if same
----

==== Error Reporting

[source,postscript]
----
errordict /handleerror {
  $error begin
    (Error in context:\n) print
    countdictstack array dictstack
    { = } forall
  end
} put
----

=== Common Pitfalls

WARNING: *Array Must Be Large Enough* - If array length < dictionary stack depth, [`rangecheck`] error occurs.

[source,postscript]
----
2 array dictstack  % Error if dict stack depth > 2
----

WARNING: *Returns Subarray* - Result may be smaller than input array.

[source,postscript]
----
10 array dictstack
% Returns subarray of actual length, not full 10 elements
----

TIP: *Use countdictstack* - Allocate array of correct size:

[source,postscript]
----
countdictstack array dictstack  % Always correct size
----

=== Error Conditions

[cols="1,3"]
|===
| Error | Condition

| [`invalidaccess`]
| Dictionary on stack has no-access attribute

| [`rangecheck`]
| Array too small for dictionary stack

| [`stackunderflow`]
| No operand on stack

| [`typecheck`]
| Operand is not an array
|===

=== Implementation Notes

* Copies dictionary references (not the dictionaries themselves)
* Very fast operation
* Useful for debugging and state management
* Result shares dictionary objects with stack

=== See Also

* link:/docs/commands/references/countdictstack/[`countdictstack`] - Get stack depth
* link:/docs/commands/references/begin/[`begin`] - Push dictionary
* link:/docs/commands/references/end/[`end`] - Pop dictionary
* link:/docs/commands/references/currentdict/[`currentdict`] - Get current dictionary