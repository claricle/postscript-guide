---
layout: default
title: currentgray
parent: Command Reference
nav_order: 20
---

== currentgray

Returns current color as gray value.

=== Syntax

----
– currentgray → num
----

=== Stack Effects

.Before
[cols="1,3"]
|===
| Level | Object

| (empty)
| –
|===

.After
[cols="1,3"]
|===
| Level | Object

| 0
| `num` (0.0 = black to 1.0 = white)
|===

=== Description

link:/docs/commands/references/currentgray/[`currentgray`] returns the gray value of the current color parameter in the graphics state.

* If the current color space is **DeviceGray**, link:/docs/commands/references/currentgray/[`currentgray`] returns the color value most recently specified to link:/docs/commands/references/setgray/[`setgray`] or [`setcolor`].
* If the current color space is **DeviceRGB** or **DeviceCMYK**, link:/docs/commands/references/currentgray/[`currentgray`] converts the current color to a gray value using standard conversion formulas.
* For any other color space, link:/docs/commands/references/currentgray/[`currentgray`] returns **0.0** (black).

The returned value is always in the range 0.0 (black) to 1.0 (white).

=== PostScript Level

*Level 1* and later

=== Examples

.Querying current gray
[source,postscript]
----
0.5 setgray
currentgray
% Stack: 0.5
----

.Converting from RGB
[source,postscript]
----
1 0 0 setrgbcolor  % Red
currentgray
% Stack: 0.3 (approximate gray equivalent)
----

.Saving and restoring gray
[source,postscript]
----
currentgray        % Save current
/savedGray exch def

0 setgray          % Change to black
drawShape

savedGray setgray  % Restore
----

.Conditional drawing based on color
[source,postscript]
----
currentgray 0.5 lt {
  % Current color is dark
  drawWithWhiteOutline
} {
  % Current color is light
  drawWithBlackOutline
} ifelse
----

=== Common Use Cases

==== Color State Preservation

[source,postscript]
----
/DrawWithTemporaryGray {
  % Save current gray
  currentgray

  % Draw with specific gray
  0.7 setgray
  drawElement

  % Restore
  setgray
} def
----

==== Adaptive Rendering

[source,postscript]
----
/DrawAdaptive {
  currentgray
  dup 0.5 lt {
    % Dark color - use light decorations
    pop
    1 setgray
    drawDecorations
  } {
    % Light color - use dark decorations
    pop
    0 setgray
    drawDecorations
  } ifelse
} def
----

==== Color Space Detection

[source,postscript]
----
/IsGrayColorSpace {
  currentgray
  0.5 setgray
  currentgray 0.5 eq
  % If true, was already in DeviceGray
} def
----

==== Monochrome Validation

[source,postscript]
----
/EnsureGrayscale {
  currentgray setgray  % Force to gray
} def
----

=== Common Pitfalls

WARNING: *Color Space Conversion* - Conversion from RGB/CMYK to gray may lose color information.

[source,postscript]
----
1 0 0 setrgbcolor  % Red
currentgray        % ~0.3
setgray            % Now gray, not red
----

WARNING: *Returns 0.0 for Unknown Spaces* - Pattern and other color spaces return black.

[source,postscript]
----
/Pattern setcolorspace
myPattern setcolor
currentgray        % Returns 0.0
----

WARNING: *Approximate Conversion* - RGB/CMYK to gray conversion is approximate.

[source,postscript]
----
0.5 0.5 0.5 setrgbcolor
currentgray
% May not be exactly 0.5 due to conversion
----

TIP: *Use for Monochrome Output* - Good for ensuring grayscale rendering.

=== Error Conditions

[cols="1,3"]
|===
| Error | Condition

| [`stackoverflow`]
| No room on operand stack
|===

=== Implementation Notes

* Very fast query operation
* No modification to graphics state
* Always returns value in range 0.0 to 1.0
* Conversion formulas are device-independent
* Level 1 operator (widely supported)

=== Color Conversion Formulas

When converting from other color spaces:

.RGB to Gray
----
gray = 0.3 × red + 0.59 × green + 0.11 × blue
----

.CMYK to Gray (approximate)
----
gray = 1 - min(1, 0.3×cyan + 0.59×magenta + 0.11×yellow + black)
----

.Other Spaces
----
gray = 0.0
----

=== See Also

* link:/docs/commands/references/setgray/[`setgray`] - Set gray color
* link:/docs/commands/references/currentrgbcolor/[`currentrgbcolor`] - Get RGB color
* link:/docs/commands/references/currentcmykcolor/[`currentcmykcolor`] - Get CMYK color (Level 2)
* link:/docs/commands/references/currenthsbcolor/[`currenthsbcolor`] - Get HSB color
