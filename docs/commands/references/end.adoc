---
layout: default
title: end
parent: Command Reference
nav_order: 3
---

== end

Pops the current dictionary from the dictionary stack.

=== Syntax

----
– end → –
----

=== Stack Effects

.Before
[cols="1,3"]
|===
| Level | Object

| (none)
| Dictionary stack has at least 3 dictionaries
|===

.After
[cols="1,3"]
|===
| Level | Object

| (none)
| Dictionary stack decreased by one
|===

=== Description

link:/docs/commands/references/end/[`end`] pops the current dictionary off the dictionary stack, making the dictionary below it the new current dictionary.

If link:/docs/commands/references/end/[`end`] attempts to pop the bottommost instance of `userdict`, it executes [`dictstackunderflow`] error. The permanent dictionaries (`systemdict`, `globaldict`, `userdict`) cannot be removed.

=== PostScript Level

*Level 1* and later

=== Examples

.Balanced begin/end
[source,postscript]
----
10 dict begin
  /x 100 def
end
% x no longer accessible
----

.Nested scopes
[source,postscript]
----
dict1 begin
  /var1 1 def
  dict2 begin
    /var2 2 def
  end
  % var2 no longer accessible
  % var1 still accessible
end
% var1 no longer accessible
----

.Error recovery
[source,postscript]
----
{
  mydict begin
  % ... operations that might fail ...
  end
} stopped {
  end  % Clean up dict stack on error
} if
----

=== Common Use Cases

==== Scoped Definitions

[source,postscript]
----
5 dict begin
  /temp 42 def
  % Use temp
  temp 2 mul
end
% temp no longer defined
----

==== Configuration Blocks

[source,postscript]
----
/config 20 dict def
config begin
  /setting1 value1 def
  /setting2 value2 def
end
----

=== Common Pitfalls

WARNING: *Unmatched end* - Executing link:/docs/commands/references/end/[`end`] without matching link:/docs/commands/references/begin/[`begin`] causes [`dictstackunderflow`].

[source,postscript]
----
end  % Error: no matching begin
----

WARNING: *Cannot Pop Permanent Dictionaries* - Cannot pop `systemdict` or the bottommost `userdict`.

[source,postscript]
----
% After many ends...
end  % Eventually: dictstackunderflow
----

TIP: *Use Defensive Coding* - In error handlers, ensure dictionary stack is properly balanced.

=== Error Conditions

[cols="1,3"]
|===
| Error | Condition

| [`dictstackunderflow`]
| Attempt to pop bottommost userdict, or stack already at minimum
|===

=== Implementation Notes

* Dictionary stack minimum: systemdict, userdict (Level 1)
* Dictionary stack minimum: systemdict, globaldict, userdict (Level 2)
* Very fast operation
* Does not modify operand stack

=== Best Practices

.Always balance begin/end
[source,postscript]
----
dict begin
  % ... operations ...
end  % Always match
----

.Use in procedures
[source,postscript]
----
/myProc {
  10 dict begin
    % Local scope
  end
} def
----

=== See Also

* link:/docs/commands/references/begin/[`begin`] - Push dictionary onto stack
* link:/docs/commands/references/currentdict/[`currentdict`] - Get current dictionary
* link:/docs/commands/references/countdictstack/[`countdictstack`] - Count stack depth
* link:/docs/commands/references/dictstack/[`dictstack`] - Examine dictionary stack