---
layout: default
title: stop
parent: Control Flow
grand_parent: Command Reference
nav_order: 7
---

== stop

Terminates execution of the innermost stopped context.

=== Syntax

----
– stop → –
----

=== Stack Effects

.Before/After
[cols="1,3"]
|===
| Level | Object

| (varies)
| Unwinds to stopped context
|===

=== Description

link:stop.adoc[`stop`] terminates execution of the innermost, dynamically enclosing instance of a xref:../stopped.adoc[`stopped`] context, without regard to lexical relationship.

When link:stop.adoc[`stop`] executes:
1. Pops execution stack down to the xref:../stopped.adoc[`stopped`] operator level
2. Pushes `true` on the operand stack
3. Resumes execution after the xref:../stopped.adoc[`stopped`] operator

The operand and dictionary stacks are not affected - any objects pushed during stopped context execution remain.

=== PostScript Level

*Level 1* and later

=== Examples

.Basic error handling
[source,postscript]
----
{
  % ... code ...
  errorCondition { stop } if
  % ... more code ...
} stopped {
  (Error occurred) print
} if
----

.Graceful failure
[source,postscript]
----
{
  riskyOperation
} stopped {
  % stop was called
  (Operation failed, using default) print
  defaultValue
} if
----

.Error propagation
[source,postscript]
----
/safeDiv {
  dup 0 eq { pop stop } if
  div
} def

{ 10 0 safeDiv } stopped {
  (Division by zero avoided) print
  0  % Default result
} if
----

=== Common Use Cases

==== Error Recovery

[source,postscript]
----
{
  file readline not { stop } if
  processLine
} stopped {
  file closefile
  (Error reading file) print
} if
----

==== Validation

[source,postscript]
----
/validate {
  conditions {
    not { stop } if
  } forall
} def

{ validate processData } stopped {
  (Validation failed) print
} if
----

==== Safe Execution

[source,postscript]
----
/trySeveral {
  {
    method1 exit
  } stopped pop
  {
    method2 exit
  } stopped pop
  {
    method3 exit
  } stopped pop
  % All failed
  fallbackMethod
} def
----

=== Common Pitfalls

WARNING: *Requires stopped Context* - Without enclosing xref:../stopped.adoc[`stopped`], prints error and calls link:quit.adoc[`quit`].

[source,postscript]
----
{ stop } exec  % Prints error, executes quit
                % (Only in top-level context)
----

WARNING: *Doesn't Clean Stacks* - Objects remain on operand/dict stacks.

[source,postscript]
----
{
  1 2 3  % Push values
  stop
} stopped pop
% Stack still contains: 1 2 3
----

TIP: *Use for Error Signaling* - Preferred way to signal errors in custom operators.

=== Error Conditions

[cols="1,3"]
|===
| Error | Condition

| (none directly)
| If no enclosing stopped, interpreter handles it
|===

=== Implementation Notes

* Unwinds execution stack only
* Operand and dictionary stacks preserved
* Very fast unwinding
* Standard error mechanism

=== Pattern: Custom Error Handling

[source,postscript]
----
/myOperator {
  % Validate inputs
  validationFailed { stop } if

  % Perform operation
  { riskyCode } stopped { stop } if

  % Return results
} def

% Usage
{ myOperator } stopped {
  % Handle any error
  handleError
} if
----

=== See Also

* xref:../stopped.adoc[`stopped`] - Create stopped context
* xref:../exit.adoc[`exit`] - Exit loop
* xref:../quit.adoc[`quit`] - Terminate interpreter
* Error Handling (to be documented)