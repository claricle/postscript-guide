---
layout: default
title: arcto
parent: Path Construction
grand_parent: Command Reference
nav_order: 10
---

== arcto

Appends an arc defined by two tangent lines and returns the tangent points.

=== Syntax

----
x1 y1 x2 y2 r arcto â†’ xt1 yt1 xt2 yt2
----

=== Stack Effects

.Before
[cols="1,3"]
|===
| Level | Object

| 4
| `r` (number - arc radius)

| 3
| `y2` (number - second tangent point y)

| 2
| `x2` (number - second tangent point x)

| 1
| `y1` (number - first tangent point y)

| 0
| `x1` (number - first tangent point x)
|===

.After
[cols="1,3"]
|===
| Level | Object

| 3
| `yt2` (number - second tangent point y)

| 2
| `xt2` (number - second tangent point x)

| 1
| `yt1` (number - first tangent point y)

| 0
| `xt1` (number - first tangent point x)
|===

=== Description

link:arcto.adoc[`arcto`] produces the same effect as xref:arct.adoc[`arct`]. It also returns the two tangent point coordinates (xt1, yt1) and (xt2, yt2) in user space.

The arc is defined by:
1. A tangent line from the current point (x0, y0) to (x1, y1)
2. A tangent line from (x1, y1) to (x2, y2)
3. A radius r

The arc is tangent to both lines, and the tangent points are returned on the stack.

link:arcto.adoc[`arcto`] is not allowed as an element of a user path, whereas xref:arct.adoc[`arct`] is allowed.

=== PostScript Level

*Level 1* and later

=== Examples

.Getting tangent points
[source,postscript]
----
newpath
100 100 moveto
200 100 200 200 30 arcto
% Stack now has: xt1 yt1 xt2 yt2
% xt1, yt1 is where arc starts on first line
% xt2, yt2 is where arc ends on second line
pop pop pop pop              % Discard tangent points
stroke
----

.Using tangent points for markers
[source,postscript]
----
/drawMarkerAtTangents {
  % x1 y1 x2 y2 radius
  arcto

  % Mark second tangent point
  gsave
  newpath
  0 5 rlineto
  5 0 rlineto
  0 -5 rlineto
  closepath
  fill
  grestore

  % Mark first tangent point
  gsave
  newpath
  0 5 rlineto
  5 0 rlineto
  0 -5 rlineto
  closepath
  fill
  grestore
} def

newpath
100 100 moveto
200 100 200 200 25 drawMarkerAtTangents
stroke
----

.Calculating arc length
[source,postscript]
----
/arcLength {
  % Returns approximate arc length
  % x1 y1 x2 y2 radius -> length
  arcto

  % Calculate distance between tangent points
  /yt2 exch def /xt2 exch def
  /yt1 exch def /xt1 exch def

  xt2 xt1 sub dup mul
  yt2 yt1 sub dup mul
  add sqrt
} def

newpath
100 100 moveto
200 100 200 200 30 arcLength
% Returns approximate arc length
----

=== Common Use Cases

==== Precise Corner Construction

[source,postscript]
----
/preciseRoundedCorner {
  % Uses tangent points for exact positioning
  % x1 y1 x2 y2 radius
  arcto

  % Save tangent points for later use
  /yt2 exch def /xt2 exch def
  /yt1 exch def /xt1 exch def

  % Could use tangent points for:
  % - Adding decorations at corners
  % - Calculating dimensions
  % - Placing text labels
} def
----

==== Creating Annotated Diagrams

[source,postscript]
----
/annotatedArc {
  % x1 y1 x2 y2 radius label
  /label exch def
  /r exch def
  /y2 exch def /x2 exch def
  /y1 exch def /x1 exch def

  % Draw the arc and get tangent points
  x1 y1 x2 y2 r arcto
  /yt2 exch def /xt2 exch def
  /yt1 exch def /xt1 exch def

  % Place label at midpoint of arc
  gsave
  xt1 xt2 add 2 div yt1 yt2 add 2 div moveto
  label show
  grestore
} def

newpath
100 100 moveto
200 100 200 200 30 (Arc) annotatedArc
----

==== Measuring Corner Geometry

[source,postscript]
----
/measureCorner {
  % Returns corner dimensions
  % x1 y1 x2 y2 radius -> setback1 setback2 arclen
  5 copy arcto

  % Calculate setbacks (distances from corner to tangent points)
  /yt2 exch def /xt2 exch def
  /yt1 exch def /xt1 exch def

  % Setback on first line
  currentpoint
  /y0 exch def /x0 exch def
  xt1 x0 sub dup mul yt1 y0 sub dup mul add sqrt

  % Setback on second line (from x1,y1 to xt1,yt1)
  xt1 5 index sub dup mul yt1 4 index sub dup mul add sqrt

  % Arc length (approximate)
  xt2 xt1 sub dup mul yt2 yt1 sub dup mul add sqrt
} def
----

=== Common Pitfalls

WARNING: *Not for User Paths* - Unlike xref:arct.adoc[`arct`], link:arcto.adoc[`arcto`] cannot be used in user paths.

WARNING: *Stack Management* - link:arcto.adoc[`arcto`] leaves four values on the stack. Remember to pop them if not needed.

[source,postscript]
----
newpath
100 100 moveto
200 100 200 200 20 arcto
% Stack has 4 extra values!
stroke                        % May cause typecheck error
----

TIP: *Use When You Need Tangent Points* - If you don't need the tangent points, use xref:arct.adoc[`arct`] instead for cleaner stack management.

=== Error Conditions

[cols="1,3"]
|===
| Error | Condition

| [`limitcheck`]
| Path becomes too complex for implementation

| [`nocurrentpoint`]
| Current path is empty (no current point defined)

| [`stackunderflow`]
| Fewer than 5 operands on stack

| [`typecheck`]
| Any operand is not a number

| [`undefinedresult`]
| Degenerate tangent configuration
|===

=== Implementation Notes

* Identical path construction to xref:arct.adoc[`arct`]
* Returns tangent points in user space coordinates
* Tangent points are on the original tangent lines, not the arc
* Useful for geometric calculations and annotations
* Cannot be encoded in user paths

=== Performance Considerations

* Slightly slower than xref:arct.adoc[`arct`] due to returning tangent points
* Overhead is minimal for most applications
* Consider using xref:arct.adoc[`arct`] if tangent points aren't needed

=== See Also

* xref:arct.adoc[`arct`] - Arc by tangent (no tangent point return)
* xref:arc.adoc[`arc`] - Counterclockwise circular arc
* xref:arcn.adoc[`arcn`] - Clockwise circular arc
* xref:currentpoint.adoc[`currentpoint`] - Get current point