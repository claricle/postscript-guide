---
layout: default
title: widthshow
parent: "Font and Text"
grand_parent: "Command Reference"
nav_order: 10
---

== widthshow

Show text with selective character width adjustment.

=== Syntax

----
cx cy char string widthshow → -
----

=== Stack Effects

**Before:**
```
cx cy char string
```

**After:**
```
(empty)
```

=== Description

xref:../widthshow.adoc[`widthshow`] paints the characters of `string` in a manner similar to xref:../show.adoc[`show`]. But while doing so, xref:../widthshow.adoc[`widthshow`] adjusts the width of each occurrence of the character `char` by adding `cx` to its x width and `cy` to its y width, thus modifying the spacing between it and the next character.

The `char` parameter is an integer used as a character code. This operator enables fitting a string of text to a specific width by adjusting the width of all occurrences of some specific character, such as the space character.

=== Parameters

**cx** (`number`)
: Amount to add to x width of target character

**cy** (`number`)
: Amount to add to y width of target character

**char** (`integer`)
: Character code to adjust (typically space = 32 or 8#040)

**string** (`string`)
: The text to display

=== Character Code Interpretation

**For base fonts:**
: `char` is simply an integer in the range 0-255 compared to successive elements of `string`

**For composite fonts:**
: `char` is compared to an integer computed from the font mapping algorithm. The font number `f` and character code `c` selected by the algorithm are combined:
- For FMapType 4 and 5: `(f × 128) + c`
- For other FMapType values: `(f × 256) + c`

=== Examples

==== Adjusting Space Character Width

[source,postscript]
----
/Helvetica findfont 12 scalefont setfont

14 60 moveto (Normal spacing) show
14 46 moveto 6 0 32 (Wide word spacing) widthshow
% 32 is ASCII code for space
----

==== Using Octal Character Code

[source,postscript]
----
/Helvetica findfont 12 scalefont setfont

100 700 moveto
6 0 8#040 (Wide word spacing) widthshow
% 8#040 is octal for space (32 decimal)
----

==== Justified Text with Space Adjustment

[source,postscript]
----
/justifyWithSpaces {  % string targetWidth justifyWithSpaces -
  % Count spaces in string
  0 exch
  { dup 32 eq { pop 1 add } { pop } ifelse } forall
  % Stack: targetWidth spaceCount

  dup 0 eq {
    % No spaces, just show
    pop pop show
  } {
    % Calculate space adjustment
    3 -1 roll              % spaceCount targetWidth string
    1 index stringwidth pop % Get current width
    sub exch div           % (targetWidth - currentWidth) / spaceCount
    0 exch 32              % cx=adjustment, cy=0, char=32
    4 -1 roll widthshow    % Apply
  } ifelse
} def

100 700 moveto
(This text will be justified) 400 justifyWithSpaces
----

==== Adjusting Multiple Character Types

[source,postscript]
----
% Adjust spaces first
100 100 moveto
3 0 32 (Text with wide spaces) widthshow

% For multiple character adjustments, cascade:
currentpoint moveto
2 0 65 (Adjust A character) widthshow  % Adjust 'A'
----

=== Errors

**invalidaccess**
: Font or string has restricted access

**invalidfont**
: Current font is not valid

**nocurrentpoint**
: Current point is not defined

**stackunderflow**
: Fewer than four operands on stack

**typecheck**
: `cx`/`cy` not numbers, `char` not integer, or `string` not string

**rangecheck**
: Character mapping goes out of bounds

=== Width Adjustment Formula

For each character `c` in the string:

----
if c == char:
  effectiveWidth(c) = characterWidth(c) + (cx, cy)
else:
  effectiveWidth(c) = characterWidth(c)
----

=== Common Character Codes

[cols="2,1,2"]
|===
| Character | Decimal | Octal

| Space
| 32
| 8#040

| Tab
| 9
| 8#011

| Newline
| 10
| 8#012

| Hyphen
| 45
| 8#055

| Period
| 46
| 8#056
|===

=== Use Cases

==== Word Spacing for Justification

[source,postscript]
----
/adjustSpaces {  % adjustment string adjustSpaces -
  0 exch 32 4 -1 roll widthshow
} def

100 700 moveto
5 (Widely spaced words) adjustSpaces
----

==== Em-Dash Adjustment

[source,postscript]
----
% Reduce space around em-dash (character 208 in some encodings)
/Helvetica findfont 12 scalefont setfont
100 100 moveto
-2 0 208 (Text—with—em-dashes) widthshow
----

==== Compensating for Printer Resolution

[source,postscript]
----
% Fine-tune spacing for specific output device
/deviceAdjust {
  % Get device resolution
  matrix defaultmatrix dtransform
  dup mul exch dup mul add sqrt  % Calculate DPI

  300 div  % Normalize to 300 DPI
  0 exch 32 4 -1 roll widthshow
} def

(Device-adjusted text) deviceAdjust
----

=== Advanced Techniques

==== Conditional Spacing

[source,postscript]
----
/conditionalSpacing {  % string conditionalSpacing -
  % Only adjust if string contains target character
  dup 32 search {
    % Contains space
    pop pop pop
    3 0 32 4 -1 roll widthshow
  } {
    % No spaces, use normal show
    show
  } ifelse
} def
----

==== Tracking (Typography)

[source,postscript]
----
% Letter spacing control for display type
/looseTracking {  % string looseTracking -
  % Add space to every character (including spaces)
  % This requires combining techniques
  dup stringwidth pop  % Original width
  1 index length 1 add 10 mul add  % Add 10 units per char
  2 div                % Center
  neg 0 rmoveto        % Adjust position
  1.5 0 32 4 -1 roll widthshow  % Wider spaces
} def
----

=== Performance Considerations

- Slightly slower than xref:../show.adoc[`show`] due to conditional width adjustment
- Still benefits from font caching
- More efficient than xref:../kshow.adoc[`kshow`] for simple spacing needs
- Character matching is done by simple integer comparison (fast)

=== Comparison with Other Spacing Operators

[cols="2,3"]
|===
| Operator | Spacing Adjustment

| xref:../show.adoc[`show`]
| None (uses character widths as-is)

| xref:../ashow.adoc[`ashow`]
| Uniform adjustment to all characters

| xref:../widthshow.adoc[`widthshow`]
| Adjustment to specific character only

| xref:../awidthshow.adoc[`awidthshow`]
| Both uniform and character-specific

| xref:../kshow.adoc[`kshow`]
| Procedural control between each pair
|===

=== See Also

- xref:../show.adoc[`show`] - Basic text painting
- xref:../ashow.adoc[`ashow`] - Show with uniform character spacing
- xref:../awidthshow.adoc[`awidthshow`] - Combine ashow and widthshow
- xref:../kshow.adoc[`kshow`] - Show with kerning procedure
- xref:../cshow.adoc[`cshow`] - Show with procedure per character
- xref:../stringwidth.adoc[`stringwidth`] - Calculate text width