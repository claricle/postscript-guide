---
layout: default
title: makefont
parent: "Font and Text"
grand_parent: "Command Reference"
nav_order: 3
---

== makefont

Transform font by arbitrary matrix.

=== Syntax

----
font matrix makefont → font'
----

=== Stack Effects

**Before:**
```
font matrix
```

**After:**
```
font'
```

=== Description

xref:../makefont.adoc[`makefont`] applies `matrix` to `font`, producing a new `font'` whose characters are transformed by `matrix` when they are shown. xref:../makefont.adoc[`makefont`] first creates a copy of `font`. Then it replaces the new font's `FontMatrix` entry with the result of concatenating the existing `FontMatrix` with `matrix`. It inserts two additional entries, `OrigFont` and `ScaleMatrix`, whose purpose is internal to the implementation. Finally, it returns the result as `font'`.

The xref:../makefont.adoc[`makefont`], xref:../scalefont.adoc[`scalefont`], and `selectfont` operators produce a font dictionary derived from an original font dictionary, but with the `FontMatrix` entry altered. The derived font dictionary is allocated in local or global VM according to whether the original font dictionary is in local or global VM. This is independent of the current VM allocation mode.

Normally, xref:../makefont.adoc[`makefont`] copies only the font dictionary. Subsidiary objects, such as the `CharStrings` and `FontInfo` dictionaries, are shared with the original font. However, if `font` is a composite font, xref:../makefont.adoc[`makefont`] also copies the font dictionaries of any descendant composite fonts. It does not copy descendant base fonts.

Showing characters from the transformed font produces the same results as showing from the original font after having transformed user space by the same matrix. xref:../makefont.adoc[`makefont`] is essentially a convenience operator that permits the desired transformation to be encapsulated in the font description.

The most common transformation is to scale a font by a uniform factor in both x and y. xref:../scalefont.adoc[`scalefont`] is a special case of the more general xref:../makefont.adoc[`makefont`] and should be used for such uniform scaling.

The interpreter keeps track of font dictionaries recently created by xref:../makefont.adoc[`makefont`]. Calling xref:../makefont.adoc[`makefont`] multiple times with the same font and matrix will usually return the same `font'` rather than create a new one. However, it is usually more efficient for a PostScript language program to apply xref:../makefont.adoc[`makefont`] only once for each font that it needs and to keep track of the resulting font dictionaries on its own.

=== Parameters

**font** (`dictionary`)
: The original font dictionary to transform

**matrix** (`array`)
: A 6-element transformation matrix [a b c d tx ty]

=== Returns

**font'** (`dictionary`)
: A new font dictionary with transformed character metrics

=== Examples

==== Non-Uniform Scaling (Condensed Font)

[source,postscript]
----
/Helvetica findfont
[10 0 0 12 0 0] makefont setfont

% Creates a 12-unit high font (12-point in default user space)
% with characters condensed in x dimension by ratio of 10/12
----

==== Oblique (Slanted) Font

[source,postscript]
----
/Helvetica findfont
[12 0 3 12 0 0] makefont setfont

% Creates an oblique/italic effect
% Characters are slanted to the right
----

==== Scaled and Rotated Font

[source,postscript]
----
/Helvetica findfont
matrix
12 12 scale      % Scale to 12 points
45 rotate        % Rotate 45 degrees
makefont setfont

% Characters are scaled and rotated
----

==== Mirror Font (Horizontal Flip)

[source,postscript]
----
/Helvetica findfont
[-12 0 0 12 0 0] makefont setfont

% Negative x scale creates mirror image
----

=== Errors

**invalidfont**
: If `font` is not a valid font dictionary

**rangecheck**
: If `matrix` is not exactly 6 elements or values exceed limits

**stackunderflow**
: If fewer than two operands are on the stack

**typecheck**
: If `font` is not a dictionary or `matrix` is not an array

**VMerror**
: Insufficient VM to create the new font dictionary

=== Font Matrix Transformation

The transformation is applied by modifying the `FontMatrix`:

----
FontMatrix' = matrix × FontMatrix
----

The matrix format is:

----
[a  b  c  d  tx  ty]
----

This transforms coordinates as:

----
x' = a×x + c×y + tx
y' = b×x + d×y + ty
----

=== Common Transformation Patterns

[cols="2,3"]
|===
| Effect | Matrix

| **Uniform scaling by s**
| `[s 0 0 s 0 0]`

| **Horizontal scaling by sx**
| `[sx 0 0 1 0 0]`

| **Vertical scaling by sy**
| `[1 0 0 sy 0 0]`

| **Slant/oblique by angle θ**
| `[1 0 tan(θ) 1 0 0]`

| **Rotation by angle θ**
| `[cos(θ) sin(θ) -sin(θ) cos(θ) 0 0]`

| **Horizontal flip**
| `[-1 0 0 1 0 0]`

| **Vertical flip**
| `[1 0 0 -1 0 0]`
|===

=== See Also

- xref:../findfont.adoc[`findfont`] - Obtain font dictionary by name
- xref:../scalefont.adoc[`scalefont`] - Scale font by uniform factor (simpler)
- xref:../setfont.adoc[`setfont`] - Establish current font
- xref:../currentfont.adoc[`currentfont`] - Get current font dictionary