---
layout: default
title: rectfill
parent: Painting
grand_parent: Command Reference
nav_order: 12
---

== rectfill

Fills one or more rectangles with the current color.

=== Syntax

----
x y width height rectfill → -
numarray rectfill → -
numstring rectfill → -
----

=== Stack Effects

.First form (single rectangle)
[cols="1,3"]
|===
| Level | Object

| 3
| `height` (number)

| 2
| `width` (number)

| 1
| `y` (number)

| 0
| `x` (number)
|===

.Second form (array)
[cols="1,3"]
|===
| Level | Object

| 0
| `numarray` (array of numbers)
|===

.Third form (encoded string)
[cols="1,3"]
|===
| Level | Object

| 0
| `numstring` (encoded number string)
|===

.After (all forms)
[cols="1,3"]
|===
| Level | Object

| (empty)
| No results
|===

=== Description

[`rectfill`](rectfill.adoc) fills a path consisting of one or more rectangles the operands describe. In the first form, the operands are four numbers that describe a single rectangle. In the other two forms, the operand is an array or an encoded number string that describes an arbitrary number of rectangles.

[`rectfill`](rectfill.adoc) neither reads nor alters the current path in the graphics state.

In the first form, assuming width and height are positive, [`rectfill`](rectfill.adoc) is equivalent to:

[source,postscript]
----
gsave
newpath
x y moveto
width 0 rlineto
0 height rlineto
width neg 0 rlineto
closepath
fill
grestore
----

The rectangle is constructed with its lower-left corner at (x, y) and extends width units in the x direction and height units in the y direction. Negative width and height values are acceptable; they cause the rectangle to extend in the opposite direction.

For the array and string forms, the operand contains a sequence of quadruples (x, y, width, height) defining multiple rectangles. All rectangles are filled as part of a single operation.

=== PostScript Level

*Level 2* and later

=== Examples

.Filling a single rectangle
[source,postscript]
----
100 100 80 60 rectfill
----

.Filling multiple rectangles
[source,postscript]
----
[
  50 50 40 40
  100 100 60 60
  200 150 80 50
] rectfill
----

.Creating a checkerboard pattern
[source,postscript]
----
/drawCheckerboard {
  % size drawCheckerboard
  /size exch def

  0 size 8 mul {
    /y exch def
    0 size 8 mul {
      /x exch def
      x y size add 8 idiv 2 mod
      y size add 8 idiv 2 mod
      add 2 mod 0 eq {
        x y size size rectfill
      } if
    } for
  } for
} def

0 setgray
20 drawCheckerboard
----

=== Common Use Cases

==== Efficient Multiple Rectangle Fill

[source,postscript]
----
% Fill many rectangles at once
0.5 setgray
[
  10 10 50 50
  70 10 50 50
  130 10 50 50
  10 70 50 50
  70 70 50 50
  130 70 50 50
] rectfill
----

==== Grid Drawing

[source,postscript]
----
/drawGrid {
  % spacing count drawGrid
  /count exch def
  /spacing exch def

  0.9 setgray
  0 1 count {
    spacing mul
    dup 0 exch spacing count mul spacing
    rectfill
    dup 0 spacing exch spacing count mul
    rectfill
  } for
} def

20 10 drawGrid  % 20-unit spacing, 10 cells
----

==== Bar Chart

[source,postscript]
----
/drawBarChart {
  % [heights...] drawBarChart
  /heights exch def
  /barWidth 40 def
  /spacing 10 def

  0.6 setgray
  0 1 heights length 1 sub {
    /i exch def
    i barWidth spacing add mul spacing add  % x
    50                                       % y
    barWidth                                 % width
    heights i get                            % height
    rectfill
  } for
} def

[60 120 90 150 75 110] drawBarChart
----

==== Window Layout

[source,postscript]
----
/drawWindows {
  0.8 setgray
  [
    % Left column
    20 20 80 100
    20 130 80 100
    20 240 80 100
    % Right column
    110 20 80 100
    110 130 80 100
    110 240 80 100
  ] rectfill
} def

drawWindows
----

=== Common Pitfalls

WARNING: *Current Path Unaffected* - [`rectfill`](rectfill.adoc) does not modify the current path.

[source,postscript]
----
newpath
50 50 moveto
100 100 lineto

100 100 50 50 rectfill
% Original path still exists unchanged
----

WARNING: *Negative Dimensions Allowed* - Negative width and height are valid and cause reversed direction.

[source,postscript]
----
% These are equivalent:
100 100 50 50 rectfill
150 150 -50 -50 rectfill  % Same rectangle
----

WARNING: *Array Must Have Quadruples* - Array length must be a multiple of 4.

[source,postscript]
----
% Wrong - incomplete rectangle
[100 100 50] rectfill  % Error

% Correct - complete quadruples
[100 100 50 50] rectfill
----

TIP: *More Efficient Than Manual Construction* - [`rectfill`](rectfill.adoc) is optimized and faster than constructing paths manually:

[source,postscript]
----
% Slower approach
gsave
  newpath
  100 100 moveto
  50 0 rlineto
  0 50 rlineto
  -50 0 rlineto
  closepath
  fill
grestore

% Faster approach
100 100 50 50 rectfill
----

=== Error Conditions

[cols="1,3"]
|===
| Error | Condition

| [`limitcheck`]
| Too many rectangles or coordinates

| [`stackunderflow`]
| Insufficient operands on stack

| [`typecheck`]
| Operands are not numbers or valid array/string
|===

=== Implementation Notes

* [`rectfill`](rectfill.adoc) is optimized for efficiency
* Multiple rectangles are filled as a single operation
* The operation is enclosed in implicit gsave/grestore
* Rectangles can overlap without issue
* Encoded number strings provide most compact representation
* The current path is completely isolated from the operation

=== Graphics State Interaction

[`rectfill`](rectfill.adoc) uses these graphics state parameters:

* Current color and color space
* Current clipping path
* Current transformation matrix (CTM)

[`rectfill`](rectfill.adoc) does not affect:

* Current path - Completely isolated
* Any graphics state parameters
* Graphics state stack

=== Rectangle Specification

Each rectangle is specified by four numbers:

* `x` - x-coordinate of lower-left corner
* `y` - y-coordinate of lower-left corner
* `width` - horizontal extent (can be negative)
* `height` - vertical extent (can be negative)

Rectangles are always axis-aligned in user space coordinates.

=== Best Practices

==== Use for Multiple Rectangles

[source,postscript]
----
% Good: single operation
[
  10 10 50 50
  70 10 50 50
  130 10 50 50
] rectfill

% Less efficient: multiple operations
10 10 50 50 rectfill
70 10 50 50 rectfill
130 10 50 50 rectfill
----

==== Combine with Color Changes

[source,postscript]
----
% Different colors
0.3 setgray
100 100 50 50 rectfill

0.7 setgray
200 100 50 50 rectfill

0.5 setgray
150 200 50 50 rectfill
----

==== Use for Backgrounds

[source,postscript]
----
% Page background
1 setgray
0 0 612 792 rectfill

% Content area
0.95 setgray
50 50 512 692 rectfill

% Draw content
0 setgray
% ...
----

==== Create Data Structures

[source,postscript]
----
/rectangles [
  10 10 50 30
  70 10 50 30
  130 10 50 30
] def

% Use later
0.6 setgray
rectangles rectfill
----

=== Performance Considerations

* [`rectfill`](rectfill.adoc) is highly optimized for rectangular regions
* Significantly faster than equivalent path construction and fill
* Multiple rectangles in one operation are more efficient than separate operations
* Encoded number strings provide maximum efficiency
* No path construction overhead
* Ideal for UI elements, grids, and patterns

=== Comparison with Traditional Fill

.Traditional approach
[source,postscript]
----
gsave
  newpath
  100 100 moveto
  50 0 rlineto
  0 50 rlineto
  -50 0 rlineto
  closepath
  fill
grestore
----

.rectfill approach
[source,postscript]
----
100 100 50 50 rectfill
----

Benefits of [`rectfill`](rectfill.adoc):

* More concise syntax
* Faster execution
* No path construction overhead
* Automatic state isolation
* Can handle multiple rectangles efficiently

=== Advanced Techniques

==== Tiled Rectangles

[source,postscript]
----
/tileRects {
  % x y width height cols rows tileRects
  /rows exch def
  /cols exch def
  /h exch def
  /w exch def
  /y0 exch def
  /x0 exch def

  /rects rows cols mul 4 mul array def
  /idx 0 def

  0 1 rows 1 sub {
    /row exch def
    0 1 cols 1 sub {
      /col exch def
      rects idx x0 col w mul add put
      rects idx 1 add y0 row h mul add put
      rects idx 2 add w put
      rects idx 3 add h put
      /idx idx 4 add def
    } for
  } for

  rects rectfill
} def

50 50 30 25 5 4 tileRects
----

==== Histogram Visualization

[source,postscript]
----
/drawHistogram {
  % [values...] max drawHistogram
  /max exch def
  /values exch def
  /barWidth 20 def

  0.6 setgray

  /rects values length 4 mul array def
  0 1 values length 1 sub {
    /i exch def
    /x i barWidth mul 50 add def
    /height values i get max div 200 mul def

    rects i 4 mul x put
    rects i 4 mul 1 add 50 put
    rects i 4 mul 2 add barWidth 2 sub put
    rects i 4 mul 3 add height put
  } for

  rects rectfill
} def

[45 78 62 95 83 71 88] 100 drawHistogram
----

=== See Also

* xref:fill.adoc[`fill`] - Fill arbitrary path
* xref:rectstroke.adoc[`rectstroke`] - Stroke rectangles (Level 2)
* xref:rectclip.adoc[`rectclip`] - Clip to rectangles (Level 2)
* xref:stroke.adoc[`stroke`] - Stroke path
* xref:../path-construction/newpath.adoc[`newpath`] - Clear current path
* xref:../graphics-state/setgray.adoc[`setgray`] - Set gray color
* xref:../graphics-state/setrgbcolor.adoc[`setrgbcolor`] - Set RGB color
* xref:../graphics-state/gsave.adoc[`gsave`] - Save graphics state
* xref:../graphics-state/grestore.adoc[`grestore`] - Restore graphics state