---
layout: default
title: gsave
parent: Graphics State
grand_parent: Command Reference
nav_order: 1
---

== gsave

Pushes a copy of the current graphics state onto the graphics state stack.

=== Syntax

----
– gsave → –
----

=== Stack Effects

.Before/After
[cols="1,3"]
|===
| Level | Object

| (none)
| Graphics state stack increased by one
|===

=== Description

[`gsave`](gsave.adoc) pushes a copy of the current graphics state onto the graphics state stack. All elements of the graphics state are saved, including:

* Current transformation matrix (CTM)
* Current path
* Current point
* Clipping path
* Color and color space
* Line parameters (width, cap, join, miter limit, dash)
* Font
* Output device identity

Raster memory contents are NOT saved.

The saved state can later be restored by [`grestore`](grestore.adoc).

=== PostScript Level

*Level 1* and later

=== Examples

.Basic state save/restore
[source,postscript]
----
gsave
  2 setlinewidth
  0.5 setgray
  % Draw with these settings
  stroke
grestore
% Original settings restored
----

.Nested saves
[source,postscript]
----
gsave
  72 72 translate
  gsave
    45 rotate
    % Draw rotated
  grestore
  % Rotation undone, translation still active
grestore
% Both undone
----

.Isolating color changes
[source,postscript]
----
gsave
  1 0 0 setrgbcolor  % Red
  fill
grestore
% Original color restored
----

=== Common Use Cases

==== Temporary Modifications

[source,postscript]
----
/drawBox {
  gsave
    1 setlinewidth
    0 setgray
    0 0 moveto
    100 0 lineto
    100 100 lineto
    0 100 lineto
    closepath stroke
  grestore
} def
----

==== Coordinate System Isolation

[source,postscript]
----
gsave
  x y translate
  scale rotate
  % Draw in transformed space
grestore
% Original CTM restored
----

==== Multiple Graphics Elements

[source,postscript]
----
% Draw multiple independent elements
/elements [
  { drawCircle }
  { drawSquare }
  { drawTriangle }
] def

elements {
  gsave
    exec
  grestore
} forall
----

=== Common Pitfalls

WARNING: *Must Match with grestore* - Every [`gsave`](gsave.adoc) must have matching [`grestore`](grestore.adoc).

[source,postscript]
----
gsave
  % Changes
  % Missing grestore causes stack growth
----

WARNING: *Limited Stack Depth* - Graphics state stack has implementation-dependent maximum depth.

[source,postscript]
----
% Too many nested gsaves
{ gsave } repeat  % Eventually: limitcheck
----

TIP: *Use for All Temporary Changes* - Always bracket temporary state changes with [`gsave`](gsave.adoc)/[`grestore`](grestore.adoc).

=== Error Conditions

[cols="1,3"]
|===
| Error | Condition

| [`limitcheck`]
| Graphics state stack overflow
|===

=== Implementation Notes

* Copies entire state (relatively expensive operation)
* Stack typically allows 15-30 levels
* Each saved state consumes memory
* Very common operation in PostScript programs

=== What Gets Saved

.Complete list of saved parameters
* Current transformation matrix
* Current path and current point
* Clipping path
* Color space and color
* Font
* Line width, line cap, line join
* Miter limit
* Dash pattern
* Flatness
* Stroke adjustment (Level 2)
* Overprint (Level 2)
* Black generation and undercolor removal functions
* Transfer function
* Halftone screen
* Device

=== See Also

* xref:grestore.adoc[`grestore`] - Restore graphics state
* xref:grestoreall.adoc[`grestoreall`] - Restore all levels
* xref:gstate.adoc[`gstate`] - Create gstate object (Level 2)
* xref:setgstate.adoc[`setgstate`] - Set from gstate (Level 2)
* VM operations: `save`, `restore` - Also save graphics state