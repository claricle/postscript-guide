---
layout: default
title: where
parent: Dictionary Operations
grand_parent: Command Reference
nav_order: 8
---

== where

Determines which dictionary on the dictionary stack contains a given key.

=== Syntax

----
key where → dict true (if found)
          → false (if not found)
----

=== Stack Effects

.Before
[cols="1,3"]
|===
| Level | Object

| 0
| `key` (key to search for)
|===

.After (if found)
[cols="1,3"]
|===
| Level | Object

| 1
| `true`

| 0
| `dict` (dictionary containing key)
|===

.After (if not found)
[cols="1,3"]
|===
| Level | Object

| 0
| `false`
|===

=== Description

link:where.adoc[`where`] searches for _key_ in each dictionary on the dictionary stack, starting with the topmost (current) dictionary.

* If found: returns the dictionary object and `true`
* If not found: returns `false`

This allows you to determine not just whether a key exists, but also which dictionary contains it.

=== PostScript Level

*Level 1* and later

=== Examples

.Finding a key
[source,postscript]
----
/pi 3.14159 def
/pi where {
  % Stack: dict true
  pop /pi get  % Get value: 3.14159
} {
  % Not found
  0
} ifelse
----

.Conditional execution
[source,postscript]
----
/setpagedevice where {
  pop  % Level 2 available
  /A4 setpagesize
} {
  % Level 1 - use alternate method
  statusdict /a4tray known {
    statusdict begin a4tray end
  } if
} ifelse
----

.Checking multiple dictionaries
[source,postscript]
----
/x 1 def  % In userdict

5 dict begin
  /x 2 def  % In local dict

  /x where {
    % Returns local dict (searched top-down)
  } if
end
----

=== Common Use Cases

==== Feature Detection

[source,postscript]
----
/languagelevel where {
  pop languagelevel 2 ge
} {
  false  % Level 1 (languagelevel not defined)
} ifelse
----

==== Safe Definition

[source,postscript]
----
/myvar where {
  pop  % Already defined, don't redefine
} {
  /myvar defaultValue def
} ifelse
----

==== Module Loading

[source,postscript]
----
/ModuleName where {
  pop  % Module already loaded
} {
  (module.ps) run  % Load module
} ifelse
----

=== Common Pitfalls

WARNING: *Returns Dictionary, Not Value* - link:where.adoc[`where`] returns the dictionary itself, not the value.

[source,postscript]
----
/x 42 def
/x where  % Returns: userdict true (not 42!)
----

WARNING: *True on Top* - Boolean result is on top, dictionary below.

[source,postscript]
----
/key where {
  % Stack: dict true
  pop  % Remove true to access dict
  /key get
} if
----

TIP: *Idiom for Getting Value* - Common pattern to get value:

[source,postscript]
----
/key where { /key get } { defaultValue } ifelse
----

=== Error Conditions

[cols="1,3"]
|===
| Error | Condition

| [`invalidaccess`]
| Dictionary on stack has no-access attribute

| [`stackoverflow`]
| Not enough room for results

| [`stackunderflow`]
| No operand on stack

| [`typecheck`]
| Operand wrong type
|===

=== Implementation Notes

* Searches dictionary stack top-down
* Stops at first match
* Returns actual dictionary object
* Fast operation (series of hash lookups)

=== Comparison with known

[cols="2,3,3"]
|===
| Aspect | link:known.adoc[`known`] | link:where.adoc[`where`]

| Search scope
| Specific dictionary
| Entire dictionary stack

| Returns
| Boolean only
| Dictionary + boolean

| Syntax
| `dict key known`
| `key where`

| Not found
| `false`
| `false`
|===

=== See Also

* xref:../known.adoc[`known`] - Check specific dictionary
* xref:../load.adoc[`load`] - Get value from dictionary stack
* xref:../def.adoc[`def`] - Define in current dictionary
* xref:../store.adoc[`store`] - Store in dictionary stack
* xref:../array-string/get.adoc[`get`] - Get from specific dictionary